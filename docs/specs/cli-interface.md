# spec://cli/interface

## Интерфейс командной строки

**Версия**: 1.0  
**Статус**: stable  
**Модуль**: `jwl_backup_merger.py::main()`

---

## Назначение

Определяет интерфейс командной строки для пользователя.

---

## Синтаксис

```bash
python jwl_backup_merger.py <input_dir> [опции]
```

---

## Аргументы

### Позиционные

| Аргумент | Обязательный | Описание |
|----------|--------------|----------|
| `input_dir` | Да | Директория с архивами `.jwlibrary` |

---

### Опции

| Опция | Короткая | Длинная | По умолчанию | Описание |
|-------|----------|---------|--------------|----------|
| output | `-o` | `--output` | `combined_backup.jwlibrary` | Имя выходного файла |
| output-dir | — | `--output-dir` | `.` | Директория для результатов |
| verbose | `-v` | `--verbose` | `False` | Подробный вывод (debug) |
| dry-run | — | `--dry-run` | `False` | Проверка без записи |
| log-file | — | `--log-file` | `jwl_backup_merger.log` | Путь к файлу лога |

---

## Примеры использования

### Простое объединение

```bash
python jwl_backup_merger.py ./backups/
```

### С указанием имени файла

```bash
python jwl_backup_merger.py ./backups/ -o my_backup.jwlibrary
```

### С указанием директории вывода

```bash
python jwl_backup_merger.py ./backups/ --output-dir ./output/
```

### Подробный режим

```bash
python jwl_backup_merger.py ./backups/ -v
```

### Dry-run (проверка)

```bash
python jwl_backup_merger.py ./backups/ --dry-run
```

---

## Выходные коды

| Код | Описание |
|-----|----------|
| 0 | Успешное завершение |
| 1 | Ошибка (не найдены архивы, ошибка слияния) |

---

## Логирование

### Уровни

| Уровень | Когда |
|---------|-------|
| INFO | Стандартный режим |
| DEBUG | Режим `-v` / `--verbose` |

### Файлы

- Консоль: краткие сообщения
- Файл (`jwl_backup_merger.log`): подробный лог

---

## Формат вывода

### Успех

```
============================================================
ИТОГИ ВЫПОЛНЕНИЯ
============================================================
Старт: 2026-02-26 12:30:45
Финиш: 2026-02-26 12:31:00
Длительность: 0:00:15
Обработано архивов: 3

✅ СТАТУС: УСПЕШНО

Результаты по таблицам:
   Location: 50 записей
   UserMark: 150 записей
   ...
   ВСЕГО: 500 записей
============================================================
```

### Ошибка

```
============================================================
ОШИБКА ВЫПОЛНЕНИЯ
============================================================
Тип ошибки: RuntimeError
Сообщение: Ошибка при создании объединённой базы: ...
============================================================
```

---

## Валидация входных данных

1. **input_dir существует**: Если нет → ошибка, exit code 1
2. **Найдены .jwlibrary файлы**: Если нет → ошибка, exit code 1
3. **dry-run**: Только логирование, без записи

---

## История изменений

| Версия | Дата | Изменение |
|--------|------|-----------|
| 1.0 | 2026-02-26 | Initial spec |
